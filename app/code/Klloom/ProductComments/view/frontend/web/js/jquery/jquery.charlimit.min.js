!function(l){l.fn.charLimit=function(t){return void 0!==t&&void 0!==t.limit&&"number"==typeof t.limit||l.error("Option limit must be defined and must be a number."),this.each(function(){var r=l(this),c=t.limit,o=t.counter;function a(t){var e;if(void 0!==t.target.selectionStart)e=t.target.selectionEnd;else if(document.selection){t.target.focus();var n=document.selection.createRange();n.moveStart("character",-t.target.value.length),e=n.text.length}r.val(r.val().substring(0,c)),function(t,e){if(l(t.target).get(0).setSelectionRange)l(t.target).get(0).setSelectionRange(e,e);else if(l(t.target).get(0).createTextRange){var n=l(t.target).get(0).createTextRange();n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select()}a=c-r.val().length,i=r.val().length>=c-20?" warning":"",o.text(a).addClass(i);var a,i}(t,e)}o.html(c),r.keydown(function(t){var e,n=r.val().length;if(void 0!==t.target.selectionStart)e=!(t.target.selectionStart==t.target.selectionEnd);else if(document.selection){t.target.focus(),e=0<document.selection.createRange().text.length}if(c-1<n&&!e)return!1;setTimeout(function(){a(t)},1)}),r.bind("paste",function(t){setTimeout(function(){a(t)},1)})})}}(jQuery);